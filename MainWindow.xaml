<Window x:Class="ITSupportToolGUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ITSupportToolGUI"
        xmlns:converters="clr-namespace:ITSupportToolGUI.Converters"
        mc:Ignorable="d"
        Title="IT Support Tool"
        SizeToContent="Height" 
        Width="{Binding WindowWidth, Mode=TwoWay}"
        MinHeight="380" 
        MinWidth="510"
        Icon="Resources/IT-Support_Tool.ico"
        Background="#F4F6F8">

    <Window.Resources>
        <ResourceDictionary>
            <converters:BooleanToVisibilityConverter x:Key="BoolToVis"/>

            <!-- Main Button Style -->
            <Style x:Key="MainButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="#FF0E447F" />
                <Setter Property="Foreground" Value="White" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="FontSize" Value="14" />
                <Setter Property="Padding" Value="10,5" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Height" Value="30" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="5" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#0056b3" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Background" Value="Gray"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Clickable Title Style -->
            <Style x:Key="ClickableTitleStyle" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="HorizontalAlignment" Value="Left"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}">
                                <ContentPresenter />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Logo Button Style -->
            <Style x:Key="LogoButtonStyle" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="5">
                                <ContentPresenter Content="{TemplateBinding Content}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="Transparent"/>
                <Setter Property="Foreground" Value="White"/>
            </Style>

            <!-- Copyable Value Style -->
            <Style x:Key="CopyableValueStyle" TargetType="Button">
                <Setter Property="BorderBrush" Value="Transparent"/>
                <Setter Property="HorizontalAlignment" Value="Right"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Grid>
                                <Border x:Name="HoverBackground" Background="#E0E0E0" CornerRadius="3" Opacity="0"/>
                                <Border x:Name="FlashBackground" Background="#A8D1FF" CornerRadius="3" Opacity="0"/>
                                <StackPanel Orientation="Horizontal" Margin="5,2">
                                    <Image x:Name="CopyIcon" Source="Resources/copy.ico" Width="12" Height="12" Margin="0,0,5,0" Opacity="0"/>
                                    <ContentPresenter VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="CopyIcon" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.15"/>
                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.15"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>
                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="CopyIcon" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="HoverBackground" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.3"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                                <EventTrigger RoutedEvent="Button.Click">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="FlashBackground" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.1" AutoReverse="True"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- New Styles for Service Desk View -->
            <Style x:Key="CardBorderStyle" TargetType="Border">
                <Setter Property="Background" Value="White"/>
                <Setter Property="BorderBrush" Value="#E0E0E0"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="15"/>
                <Setter Property="Margin" Value="10,5"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect ShadowDepth="1" Color="#CCCCCC" Opacity="0.3" BlurRadius="5"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="CardTitleStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Foreground" Value="#0d1d41"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>

            <Style x:Key="SelectableInfoTextStyle" TargetType="TextBox">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
                <Setter Property="IsReadOnly" Value="True"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Background" Value="Transparent"/>
            </Style>

            <Style x:Key="IconTextStyle" TargetType="TextBlock">
                <Setter Property="FontFamily" Value="Segoe UI Emoji"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Margin" Value="0,0,10,0"/>
                <Setter Property="VerticalAlignment" Value="Center"/>
            </Style>

        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="200"/>
            <ColumnDefinition Width="*" MinWidth="310"/>
        </Grid.ColumnDefinitions>

        <!-- Left Navigation Panel -->
        <DockPanel Grid.Column="0" Background="#0d1d41">
            <StackPanel DockPanel.Dock="Bottom" Margin="5,10,0,3">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Button x:Name="btnSwitchToNative" Click="btnSwitchToNative_Click" Style="{StaticResource LogoButtonStyle}" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="5,0,0,5" ToolTip="{Binding SwitchToDanishTip}">
                        <Image Source="{Binding NativeFlagIconPath}" Width="30" Height="18"/>
                    </Button>
                    <Button x:Name="btnSwitchToEnglish" Click="btnSwitchToEnglish_Click" Style="{StaticResource LogoButtonStyle}" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="5,0,0,5" ToolTip="{Binding SwitchToEnglishTip}">
                        <Image Source="Resources/gbr-svg.ico" Width="30" Height="18"/>
                    </Button>
                </Grid>
            </StackPanel>
            <StackPanel>
                <Button Style="{StaticResource LogoButtonStyle}" Margin="5,5,5,15">
                    <Image Source="Resources/STARK_Group_RGB_white.png" HorizontalAlignment="Left" Width="190" Height="Auto"/>
                </Button>
                <TextBlock Text="IT Support Tool" FontWeight="Bold" FontSize="16" Margin="10,5,5,10" Foreground="#fff"/>
                <Button x:Name="btnShowServiceDesk" Content="{Binding ShowSupportLabel}" Style="{StaticResource MainButtonStyle}" Command="{Binding BackToInfoViewCommand}" ToolTip="{Binding ShowSupportToolTip}"/>
                <Button x:Name="btnOpenRemoteHelp" Content="{Binding OpenRemoteHelpLabel}" Style="{StaticResource MainButtonStyle}" Command="{Binding OpenRemoteHelpCommand}" ToolTip="{Binding OpenRemoteHelpTip}"/>
                <Button x:Name="btnShowComputerInfo" Content="{Binding ShowComputerInfoLabel}" Style="{StaticResource MainButtonStyle}" Command="{Binding ShowComputerInfoViewCommand}" ToolTip="{Binding ShowComputerInfoToolTip}"/>
                <Button x:Name="btnOpenPasswordReset" Content="{Binding OpenPasswordResetLabel}" Style="{StaticResource MainButtonStyle}" Click="btnOpenPasswordReset_Click" ToolTip="{Binding OpenPasswordResetTip}"/>
                <Button x:Name="btnAddPrinter" Content="{Binding AddPrinterLabel}" Style="{StaticResource MainButtonStyle}" Command="{Binding ShowPrinterViewCommand}" ToolTip="{Binding AddPrinterToolTip}"
                        Visibility="{Binding IsPrinterButtonVisible, Converter={StaticResource BoolToVis}}"/>
                <Button x:Name="btnRunScript" Content="{Binding RunScriptLabel}" Style="{StaticResource MainButtonStyle}" Command="{Binding RunPowerShellScriptCommand}" ToolTip="{Binding RunScriptTip}"
                        Visibility="{Binding IsPowerShellButtonVisible, Converter={StaticResource BoolToVis}}"/>
            </StackPanel>
        </DockPanel>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
            <Grid Margin="10">
                <!-- Service Desk View -->
                <StackPanel x:Name="ServiceDeskPanel" Visibility="{Binding IsServiceDeskViewVisible, Converter={StaticResource BoolToVis}}">
                    <TextBlock Text="{Binding SupportTitle, Mode=OneWay}" Margin="10,10,0,7" FontWeight="Bold" FontSize="20" Foreground="#0d1d41"/>

                    <!-- Denmark Service Desk -->
                    <Border Style="{StaticResource CardBorderStyle}" Visibility="{Binding IsDenmarkServiceDeskVisible, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="🕒" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ServiceDeskHours, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="📞" Style="{StaticResource IconTextStyle}" Margin="0,5,10,5"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ServiceDeskPhone, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}" Margin="0,5,0,5"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="📧" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ServiceDeskEmail, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Norway Service Desk -->
                    <Border Style="{StaticResource CardBorderStyle}" Visibility="{Binding IsNorwayServiceDeskVisible, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="🕒" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ServiceDeskHours, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="📞" Style="{StaticResource IconTextStyle}" Margin="0,5,10,5"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ServiceDeskPhone, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}" Margin="0,5,0,5"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="📧" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ServiceDeskEmail, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Sweden Service Desk -->
                    <Border Style="{StaticResource CardBorderStyle}" Visibility="{Binding IsSwedenServiceDeskVisible, Converter={StaticResource BoolToVis}}">
                        <StackPanel>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="🕒" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ServiceDeskHours, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="📞" Style="{StaticResource IconTextStyle}" Margin="0,5,10,5"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ServiceDeskPhone, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}" Margin="0,5,0,5"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="📧" Style="{StaticResource IconTextStyle}"/>
                                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ServiceDeskEmail, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Employee Wi-Fi Card -->
                    <Border Style="{StaticResource CardBorderStyle}">
                        <StackPanel>
                            <TextBlock Text="{Binding WifiCardTitle, Mode=OneWay}" Style="{StaticResource CardTitleStyle}"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding WifiNetworkNameLabel}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding WifiEmployeeNetworkNameValue, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}" Margin="5,0,0,0"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="{Binding WifiNetworkPasswordLabel}" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,5,0,0"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding WifiEmployeeNetworkPasswordValue, Mode=OneWay}" Style="{StaticResource SelectableInfoTextStyle}" Margin="5,5,0,0"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <Grid Margin="5,15,5,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0" x:Name="btnOpenTicketSystem" Content="{Binding OpenTicketSystemLabel}" Style="{StaticResource MainButtonStyle}" Click="btnOpenTicketSystem_Click" ToolTip="{Binding OpenTicketSystemTip}"/>
                        <Button Grid.Column="1" x:Name="btnOpenITMessages" Content="{Binding OpenITMessagesLabel}" Style="{StaticResource MainButtonStyle}" Click="btnOpenITMessages_Click" ToolTip="{Binding OpenITMessagesTip}"/>
                    </Grid>
                </StackPanel>

                <!-- View 1: Computer Information Panel -->
                <StackPanel x:Name="ComputerInfoPanel" Visibility="{Binding IsComputerInfoViewVisible, Converter={StaticResource BoolToVis}}">
                    <Button Style="{StaticResource ClickableTitleStyle}" Command="{Binding CopyAllInfoCommand}" ToolTip="{Binding CopyAllInfoTip}">
                        <Label Content="{Binding ComputerInformationTitle}" Margin="10,10,0,7" FontWeight="Bold" FontSize="16"/>
                    </Button>

                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding ComputerNameLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding ComputerName}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding ComputerName}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding UserNameLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding UserName}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding UserName}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding OsVersionLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding OsVersion}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding OsVersion}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding IpAddressLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding IpAddress}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding IpAddress}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding SsidLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding Ssid}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding Ssid}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding LastRestartLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding LastRestart}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding LastRestart}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5" Visibility="{Binding IsVpnConnected, Converter={StaticResource BoolToVis}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding VpnStatusLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding VpnStatus}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding VpnStatus}"/>
                    </Grid>
                    <Grid Margin="10,5,10,5" Visibility="{Binding IsVpnConnected, Converter={StaticResource BoolToVis}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding VpnIpAddressLabel}" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource CopyableValueStyle}" Grid.Column="1" Content="{Binding VpnIpAddress}" Command="{Binding CopyToClipboardCommand}" CommandParameter="{Binding VpnIpAddress}"/>
                    </Grid>
                </StackPanel>

                <!-- View 2: Script Instructions Panel -->
                <StackPanel x:Name="InstructionsPanel" Visibility="{Binding IsInstructionsViewVisible, Converter={StaticResource BoolToVis}}">
                    <Label Content="{Binding InstructionsTitle}" Margin="10,10,0,7" FontWeight="Bold" FontSize="16"/>

                    <TextBlock Text="{Binding InstructionsStep1}" Margin="15,10,15,0" FontWeight="Bold" TextWrapping="Wrap"/>
                    <TextBlock Text="{Binding InstructionsStep1Body}" Margin="15,2,15,5" TextWrapping="Wrap"/>

                    <Separator Margin="15,10"/>

                    <TextBlock Text="{Binding InstructionsStep2}" Margin="15,5,15,0" FontWeight="Bold" TextWrapping="Wrap"/>
                    <TextBlock Text="{Binding InstructionsStep2Body}" Margin="15,2,15,5" TextWrapping="Wrap"/>

                    <Button Command="{Binding ExecuteWifiFixScriptCommand}" Style="{StaticResource LogoButtonStyle}" HorizontalAlignment="Left" Margin="15,5,15,10">
                        <Image Source="/Resources/Wifi-Login.jpg" MaxWidth="500" />
                    </Button>

                    <StackPanel Margin="30,0,15,5">
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="• " FontWeight="Bold"/>
                            <TextBlock Text="{Binding InstructionsBullet2}" TextWrapping="Wrap"/>
                        </DockPanel>

                        <StackPanel Margin="15,5,0,5">
                            <TextBlock Text="{Binding InstructionsExampleUsername}" TextWrapping="Wrap" FontStyle="Italic"/>
                            <TextBlock Text="{Binding InstructionsExamplePassword}" TextWrapping="Wrap" FontStyle="Italic" Margin="0,2,0,0"/>
                        </StackPanel>

                        <DockPanel Margin="0,5,0,5">
                            <TextBlock Text="• " FontWeight="Bold"/>
                            <TextBlock Text="{Binding InstructionsBullet3}" TextWrapping="Wrap"/>
                        </DockPanel>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="10,20,0,0">
                        <Button Content="{Binding ExecuteScriptButtonText}" Command="{Binding ExecuteWifiFixScriptCommand}" Style="{StaticResource MainButtonStyle}" MinWidth="100"/>
                        <Button Content="{Binding BackButtonText}" Command="{Binding BackToInfoViewCommand}" Style="{StaticResource MainButtonStyle}" MinWidth="100" Margin="10,5"/>
                    </StackPanel>
                </StackPanel>

                <!-- View 3: Printer Panel -->
                <StackPanel x:Name="PrinterPanel" Visibility="{Binding IsPrinterViewVisible, Converter={StaticResource BoolToVis}}">
                    <Label Content="{Binding PrinterViewTitle}" Margin="10,10,0,7" FontWeight="Bold" FontSize="16"/>

                    <Border Background="#FFFBE6" BorderBrush="#FFC107" BorderThickness="1" CornerRadius="3" Margin="15,5,15,10" Padding="10">
                        <TextBlock Text="{Binding PrinterNotice}" FontWeight="SemiBold" TextWrapping="Wrap" VerticalAlignment="Center" Foreground="#B38600"/>
                    </Border>

                    <Grid Margin="15,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Label Content="{Binding SiteIdLabel}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="1" Text="{Binding SiteId, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="5,0" FontSize="14">
                            <TextBox.InputBindings>
                                <KeyBinding Key="Enter" Command="{Binding SearchPrintersCommand}"/>
                            </TextBox.InputBindings>
                        </TextBox>
                        <Button Grid.Column="2" Content="{Binding SearchButtonText}" Command="{Binding SearchPrintersCommand}" Style="{StaticResource MainButtonStyle}" MinWidth="80" Margin="5,0,0,0"/>
                    </Grid>

                    <TextBlock Text="{Binding PrinterStatusMessage}" Margin="15,0,15,10" FontStyle="Italic"/>

                    <ListView ItemsSource="{Binding AvailablePrinters}" Margin="15,5" MaxHeight="250">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Vælg" Width="50">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Center"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Printernavn" DisplayMemberBinding="{Binding Name}" Width="450"/>
                            </GridView>
                        </ListView.View>
                    </ListView>

                    <StackPanel Orientation="Horizontal" Margin="10,20,0,0">
                        <Button Content="{Binding AddSelectedButtonText}" Command="{Binding AddSelectedPrintersCommand}" Style="{StaticResource MainButtonStyle}" MinWidth="120"/>
                        <Button Content="{Binding BackButtonText}" Command="{Binding BackToInfoViewCommand}" Style="{StaticResource MainButtonStyle}" MinWidth="100" Margin="10,5"/>
                    </StackPanel>
                </StackPanel>

                <!-- Secret Easter Egg Button -->
                <Button x:Name="secretButton" 
                        Width="20" Height="20" 
                        Opacity="0" 
                        Click="SecretButton_Click" 
                        HorizontalAlignment="Right" 
                        VerticalAlignment="Bottom" 
                        Margin="0,0,0,-5" 
                        Cursor="Hand"
                        Visibility="{Binding IsComputerInfoViewVisible, Converter={StaticResource BoolToVis}}"/>
            </Grid>
        </ScrollViewer>
    </Grid>
</Window>
